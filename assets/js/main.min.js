
import { invalid, valid, submitWithInvalid, submitWithValid, showPassword, onload_form, stopRefresh, sweetalert } from "./master/functions.js";


// const swup = new Swup();


// swup.on('contentReplaced', init);

// // than if you want to import new css rule or new scripts juste created inside init with javascript exemple:
// function init(){
//   console.log('Swup transition finished!');
// }












var datePickers = document.querySelectorAll(".date");
  datePickers.forEach(function(datePicker) {
   var datePickerId = datePicker.getAttribute("id");
   flatpickr(datePicker, {
     defaultDate: "2023-03-01", // Replace with your default date
     minDate: "2023-03-01", // Replace with your minimum date
     maxDate: "2023-12-31", // Replace with your maximum date
     dateFormat: "d-m-Y", // Replace with your desired date format
   });
 });


const phoneInputFields = document.querySelectorAll('input.phone[type*=tel]'); // Replace 'input' with the selector for your input fields

phoneInputFields.forEach(function(phoneInputField) {
  phoneInputField.addEventListener('input', function(e) {
    if (phoneInputField.value.length < 4) {
      phoneInputField.value = '+91-';
    } else if (!phoneInputField.value.startsWith('+91-')) {
      phoneInputField.value = '+91-' + phoneInputField.value.slice(4);
    }
  });
});





const inputFields = document.querySelectorAll('input, textarea'); // Replace 'input' with the selector for your input fields

inputFields.forEach(function(inputField) {
  inputField.addEventListener('input', function(e) {
    const type = inputField.getAttribute('type');
    if (type === 'email' && !isValidEmail(inputField.value)) {
      inputField.setCustomValidity('Please enter a valid email address.');
    } else if (type === 'number' && isNaN(inputField.value)) {
      inputField.setCustomValidity('Please enter a valid number.');
    } else if (type === 'tel' && inputField.classList.contains('phone') && !isValidPhoneNumber(inputField.value)) {
      inputField.setCustomValidity('Please enter a valid phone number.');
    } else if (type === 'text' && inputField.classList.contains('first-name') && !isValidName(inputField.value)) {
      inputField.setCustomValidity('Please enter a valid first name.');
    } else if (type === 'text' && inputField.classList.contains('last-name') && !isValidName(inputField.value)) {
      inputField.setCustomValidity('Please enter a valid last name.');
    } else if (type === 'tel' && inputField.classList.contains('pincode') && !isValidPincode(inputField.value)) {
      inputField.setCustomValidity('Please enter a valid Indian PIN code.');
    } else {
      inputField.setCustomValidity('');
    }

    // For textarea, show character count and increase height
    if (inputField.classList.contains('message') && inputField.maxLength !== -1) {
      const remainingChars = inputField.maxLength - inputField.value.length;
      const counter = inputField.parentNode.querySelector('.char-count');
      if (counter) {
        counter.textContent = `Characters left: ${remainingChars}`;
      }
      inputField.style.height = 'auto'; // Reset height to auto
      inputField.style.height = inputField.scrollHeight + 'px'; // Set height to content height
    }
  });
});

function isValidEmail(email) {
  // Use a regular expression to check if the email is valid
  const emailRegex = /^[\w\.-]*[a-zA-z][\w\.-]*@([\w-]+\.)+[\w-]{2,4}$/;
  return emailRegex.test(email);
}

function isValidPhoneNumber(phoneNumber) {
  // Use a regular expression to check if the phone number is valid
  const phoneRegex = /^\+91-[6-9]\d{9}$/;
  return phoneRegex.test(phoneNumber);
}

function isValidName(name) {
  // Use a regular expression to check if the name is valid
  const nameRegex = /^[\w\., -]*[a-zA-z].*[\w\., -]*$/;
  return nameRegex.test(name);
}

function isValidPincode(pincode) {
  // Use a regular expression to check if the PIN code is valid
  const pincodeRegex = /^\d{6}$/;
  return pincodeRegex.test(pincode);
}






window.onload = (event) => {
  console.log("Event Type ðŸ‘‰ " + event.type);

  
  //? ------------[select2 start]------------
  // $('body').on('shown.bs.offcanvas', '.offcanvas', function() {
  //   $(this).find('select').each(function() {
  //       let dropdownParent = $(document.body);
  //       let selectid = $(this).attr('id');
  //       dropdownParent = $('#'+selectid).parent().closest('.offcanvas').attr('id');
  //       $(this).select2({
  //           dropdownParent: $('#'+dropdownParent),
  //           "language": {
  //               "noResults": function(){
  //                   return `
  //                   <div class="w-100 d-flex gap-1 justify-content-center py-3 flex-column">
  //                       <div class="w-100 text-center">
  //                           <img src="./public/frontend/assets/img/icons/emptyState.svg" class="w-60px">
  //                       </div>
  //                       <div class="w-100 fs-14 fw-bold text-center opacity-50">
  //                           Data Not Found
  //                       </div>
  //                   </div>
  //                   `;
  //               }
  //           },
  //           escapeMarkup: function (markup) {
  //               return markup;
  //           },
  //           placeholder: $(this).data('placeholder')
  //       });
  //   });
  // });
  // function callSelect2() {
  //   $('select:not([data-select2-id])').each(function () {
  //       $(this).select2({
  //           "language": {
  //               "noResults": function(){
  //                   return `
  //                   <div class="w-100 d-flex gap-1 justify-content-center py-3 flex-column">
  //                       <div class="w-100 text-center">
  //                           <img src="./public/frontend/assets/img/icons/emptyState.svg" class="w-60px">
  //                       </div>
  //                       <div class="w-100 fs-14 fw-bold text-center opacity-50">
  //                           Data Not Found
  //                       </div>
  //                   </div>
  //                   `;
  //               }
  //           },
  //           escapeMarkup: function (markup) {
  //               return markup;
  //           },
  //           placeholder: $(this).data('placeholder')
  //       });
  //   });
  //   $("#keyskillsInput").select2("destroy").select2({
  //       "language": {
  //           "noResults": function(){
  //               return `
  //               <div class="w-100 d-flex gap-1 justify-content-center py-3 flex-column">
  //                   <div class="w-100 text-center">
  //                       <img src="./public/frontend/assets/img/icons/emptyState.svg" class="w-60px">
  //                   </div>
  //                   <div class="w-100 fs-14 fw-bold text-center opacity-50">
  //                       Data Not Found
  //                   </div>
  //               </div>
  //               `;
  //           }
  //         },
  //         closeOnSelect: false,
  //         maximumSelectionLength: 10,
  //         dropdownCssClass: 'keyskillsInputDropdown',
  //         escapeMarkup: function (markup) {
  //             return markup;
  //         },
  //         placeholder: $(this).data('placeholder'),
  //     });
  // };
  // callSelect2();

  // $(document).on('select2:open', (e) => {
  //   console.log("Event Type ðŸ‘‰ " + e.type);
  //     const selectId = e.target.id;
  //     $(".select2-search__field[aria-controls='select2-"+selectId+"-results']").each(function (key,value,){
  //         value.focus();
  //     });
  // });

  // $(document).on('change.select2', (e) => {
  //   console.log("Event Type ðŸ‘‰ " + e.type);
  // });
  // $(document).on('select2:closing', (e) => {
  //   console.log("Event Type ðŸ‘‰ " + e.type);
  // });
  // $(document).on('select2:close', (e) => {
  //   console.log("Event Type ðŸ‘‰ " + e.type);
  // });
  // $(document).on('select2:opening', (e) => {
  //   console.log("Event Type ðŸ‘‰ " + e.type);
  // });
  // $(document).on('select2:selecting', (e) => {
  //   console.log("Event Type ðŸ‘‰ " + e.type);
  // });
  // $(document).on('select2:select', (e) => {
  //   console.log("Event Type ðŸ‘‰ " + e.type);
  // });
  // $(document).on('select2:unselecting', (e) => {
  //   console.log("Event Type ðŸ‘‰ " + e.type);
  // });
  // $(document).on('select2:unselect', (e) => {
  //   console.log("Event Type ðŸ‘‰ " + e.type);
  // });
  // $(document).on('select2:clearing', (e) => {
  //   console.log("Event Type ðŸ‘‰ " + e.type);
  // });
  // $(document).on('select2:clear', (e) => {
  //   console.log("Event Type ðŸ‘‰ " + e.type);
  // });
  //! ------------[select2 end]------------
  
  
  
  
  
  
  
  


  //? ~~~~~~~~~~~~~~~~~~~~~~~~~[test page start]~~~~~~~~~~~~~~~~~~~~~~~~~
  if($('[data-page-name=test]').length) {
    console.log('Event Type ðŸ‘‰ Availabe');

  }  
  //! ~~~~~~~~~~~~~~~~~~~~~~~~~[test page end]~~~~~~~~~~~~~~~~~~~~~~~~~


  const showPasswords = document.querySelector('.show_password')
  if(showPasswords) {
    showPasswords.addEventListener("input", (event)=> {
      showPassword(event)
    }, false);
  }

}

